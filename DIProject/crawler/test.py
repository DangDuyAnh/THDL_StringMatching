import csv

to_csv = [{'name':'bob','age':25,'weight':200, 'height':181},
          {'name':'jim','age':31,'weight':180},
          {'Tên người bán': 'Mai Thành Hai', 'Số điện thoại': '0969762262', 'Tiêu đề': 'SHOPHOUSE VIEW BIỂN HTL SEASIDE PHÚ YÊN- GIÁ TỪ 11 TỈ. CHIẾT KHẤU 5%- HTLS 18 THÁNG .LH 0969762***', 'Địa chỉ': 'Dự án HTL Seaside , Đường Hùng Vương, Phường 6, Tuy Hòa, Phú Yên', 'Ngày đăng': '14/06/2022', 'Ngày hết hạn': '24/06/2022', 'Mã tin': '34063717'}]

#to_csv = [{'Tên người bán': 'Mai Thành Hai', 'Số điện thoại': '0969762262', 'Tiêu đề': 'SHOPHOUSE VIEW BIỂN HTL SEASIDE PHÚ YÊN- GIÁ TỪ 11 TỈ. CHIẾT KHẤU 5%- HTLS 18 THÁNG .LH 0969762***', 'Địa chỉ': 'Dự án HTL Seaside , Đường Hùng Vương, Phường 6, Tuy Hòa, Phú Yên', 'Ngày đăng': '14/06/2022', 'Ngày hết hạn': '24/06/2022', 'Mã tin': '34063717'}, {'Tên người bán': 'Gia Huy', 'Số điện thoại': '0786455456', 'Tiêu đề': 'GIA ĐÌNH VỀ QUÊ ĐỊNH CƯ NÊN CẦN BÁN GẤP LÔ ĐẤT 100M2 (5X20M), VỊ TRÍ ĐẸP, ĐỐI DIỆN KHU ĐÔ THỊ MP3', 'Địa chỉ': 'Đường D8, Phường Tân Định, Bến Cát, Bình Dương', 'Ngày đăng': '10/06/2022', 'Ngày hết hạn': '20/06/2022', 'Mã tin': '32387504'}, {'Tên người bán': 'Em Thơm', 'Số điện thoại': '0976491188', 'Tiêu đề': 'BÁN 20 LÔ LIỀN KỀ RẺ NHẤT DA DÃY LK35 LK36 LK34 LK38 LK37 LK26, 135M2, 62TR/M2, HINODE ROYAL PARK', 'Địa chỉ': 'Dự án Hinode Royal Park, Đường Quốc lộ 32, Xã Di Trạch, Hoài Đức, Hà Nội', 'Ngày đăng': '07/06/2022', 'Ngày hết hạn': '17/06/2022', 'Mã tin': '32209321'}, {'Tên người bán': 'NGUYỄN DIỆU LINH', 'Số điện thoại': '0916065161', 'Tiêu đề': 'BÁN SUẤT NGOẠI GIAO SHOPHOUSE SAO BIỂN, KINH ĐÔ ÁNH SÁNG DA VINHOMES THE EMPIRE GIÁ CĐT 0916065***', 'Địa chỉ': 'Dự án The Empire - Vinhomes Ocean Park 2, Văn Giang, Hưng Yên', 'Ngày đăng': '14/06/2022', 'Ngày hết hạn': '24/06/2022', 'Mã tin': '34062629'}, {'Tên người bán': 'Le Tu', 'Số điện thoại': '0777777284', 'Tiêu đề': 'CẶP NHẬT GIÁ BÁN MỚI VỀ CĂN HỘ SUNRISE CITY. CITY VIEW 1 2 3 4PN PENHOUSE 2PN GIÁ 3.1TỶ 0777777***', 'Địa chỉ': 'Dự án Sunrise City, Đường Nguyễn Hữu Thọ, Phường Tân Hưng, Quận 7, Hồ Chí Minh', 'Ngày đăng': '08/06/2022', 'Ngày hết hạn': '18/06/2022', 'Mã tin': '32845570'}, {'Tên người bán': 'Hakome House', 'Số điện thoại': '0961580805', 'Tiêu đề': 'FULL GIỎ HÀNG BÁN VINHOMES CENTRAL PARK 1 2 3 4PN, CAM KẾT HÀNG THẬT, GIÁ TỐT NHẤT KHU VỰC', 'Địa chỉ': 'Dự án Vinhomes Central Park, Điện Biên Phủ, Phường 22, Quận Bình Thạnh, Hồ Chí Minh', 'Ngày đăng': '14/06/2022', 'Ngày hết hạn': '24/06/2022', 'Mã tin': '34062437'}, {'Tên người bán': 'Trường Giang', 'Số điện thoại': '0913261111', 'Tiêu đề': 'BÁN LÔ ĐẤT VIP NHẤT VIỆT NAM 2000M2, SỔ ĐỎ LÂU DÀI, MẶT TIỀN 30M, LƯNG DỰA NÚI BA MẶT HƯỚNG BIỂN', 'Địa chỉ': 'Khu Đô Thị Du Lịch Và Bến Cảng Cao Cấp Ao Tiên , Xã Hạ Long, Vân Đồn, Quảng Ninh', 'Ngày đăng': '14/06/2022', 'Ngày hết hạn': '24/06/2022', 'Mã tin': '34062101'}, {'Tên người bán': 'Trần Thị Thu Định', 'Số điện thoại': '0911111627', 'Tiêu đề': '432M2 (10,7X40,3) VIEW ĐỒI CÓ NHÀ MẪU XEM THỰC TẾ 0911111***', 'Địa chỉ': 'Đường Quốc Lộ 20, Xã Lộc Ngãi, Bảo Lâm, Lâm Đồng', 'Ngày đăng': '07/06/2022', 'Ngày hết hạn': '17/06/2022', 'Mã tin': '33955381'}, {'Tên người bán': 'Ms Hoa', 'Số điện thoại': '0986784968', 'Tiêu đề': 'QUỸ CĂN CHUYỂN NHƯỢNG MỚI NHẤT THÁNG 6 CẮT LỖ TỪ 300TR TẠI VHOCP CÁC CĂN TỪ 1PN-2PN-3PN MIỄN PHÍ MG', 'Địa chỉ': 'Dự án Vinhomes Ocean Park Gia Lâm, Xã Dương Xá, Gia Lâm, Hà Nội', 'Ngày đăng': '09/06/2022', 'Ngày hết hạn': '19/06/2022', 'Mã tin': '33990777'}, {'Tên người bán': 'Phạm Duy Điệp', 'Số điện thoại': '0906372566', 'Tiêu đề': 'SỞ HỮU ĐẤT THỔ CƯ MẶT TIỀN ĐẠI LỘ TRUNG TÂM CHƠN THÀNH VỚI 350 TRIỆU LH: 0906372***', 'Địa chỉ': 'Chơn Thành, Bình Phước', 'Ngày đăng': '14/06/2022', 'Ngày hết hạn': '24/06/2022', 'Mã tin': '34060278'}, {'Tên người bán': 'Phòng Kinh Doanh The Matrix One', 'Số điện thoại': '0989663858', 'Tiêu đề': 'CHÍNH SÁCH MỚI THE MATRIX ONE: CHIẾT KHẤU 14% + 430 TRIỆU, HỖ TRỢ 36 THÁNG KHÔNG LÃI, GIÁ TỐT', 'Địa chỉ': 'Dự án The Matrix One, Đường Lê Quang Đạo, Phường Mễ Trì, Nam Từ Liêm, Hà Nội.', 'Ngày đăng': '10/06/2022', 'Ngày hết hạn': '20/06/2022', 'Mã tin': '33999516'}, {'Tên người bán': 'Phạm Minh Đương', 'Số điện thoại': '0856130195', 'Tiêu đề': 'SIÊU BIỆT THỰ 6* VVIP ĐẢO SAN HÔ, ĐẢO KỲ QUAN DỰ ÁN VILLA GRAN MELIA VEGA CITY NHA TRANG', 'Địa chỉ': 'Dự án Vega City, Phường Vĩnh Hòa, Nha Trang, Khánh Hòa', 'Ngày đăng': '14/06/2022', 'Ngày hết hạn': '24/06/2022', 'Mã tin': '34061612'}, {'Tên người bán': 'Phạm Minh Đương', 'Số điện thoại': '0856130195', 'Tiêu đề': 'BIỆT THỰ SUNNEVA ISLAND, VỊ TRÍ NGÃ BA SÔNG HÀN ĐỘC TÔN ĐẸP NHẤT, KHU ĐÔ THỊ ĐẲNG CẤP NHẤT ĐÀ NẴNG', 'Địa chỉ': 'Dự án Sunneva Island, Ngũ Hành Sơn, Đà Nẵng', 'Ngày đăng': '14/06/2022', 'Ngày hết hạn': '24/06/2022', 'Mã tin': '34061484'}, {'Tên người bán': 'Nguyễn Đức Vinh', 'Số điện thoại': '0986498889', 'Tiêu đề': 'TỔNG HỢP 8 CĂN ĐẸP GIÁ TỐT NHẤT THÁNG 6, QUÀ TẶNG TỚI 2,1 TỶ; NHẬN NHÀ NGAY; VAY MIỄN LÃI 36 THÁNG', 'Địa chỉ': 'Dự án The Matrix One, Đường Lê Quang Đạo, Phường Mễ Trì, Nam Từ Liêm, Hà Nội.', 'Ngày đăng': '09/06/2022', 'Ngày hết hạn': '19/06/2022', 'Mã tin': '33989430'}, {'Tên người bán': 'Bảo Khanh', 'Số điện thoại': '0948395003', 'Tiêu đề': 'BÁN CH RICCA NHÀ MỚI, THOÁNG MÁT VIEW ĐẸP CHỈ 1TỶ7 LH: 0948395***', 'Địa chỉ': 'Dự án Căn hộ Ricca Quận 9, Đường Gò Cát, Phường Phú Hữu, Quận 9, Hồ Chí Minh', 'Ngày đăng': '05/06/2022', 'Ngày hết hạn': '15/06/2022', 'Mã tin': '33738369'}, {'Tên người bán': 'Novaworld Phan Thiết', 'Số điện thoại': '0909753368', 'Tiêu đề': 'NHÀ PHỐ BIỂN NOVAWORLD PHAN THIẾT GIÁ CHỦ ĐẦU TƯ 6.5 TỶ VIEW CÔNG VIÊN, BIỆT THỰ VIEW BIỂN 16 TỶ', 'Địa chỉ': 'NovaWorld Phan Thiết, 194, Đường Lạc Long Quân, Xã Tiến Thành, Phan Thiết, Bình Thuận', 'Ngày đăng': '10/06/2022', 'Ngày hết hạn': '20/06/2022', 'Mã tin': '33015240'}, {'Tên người bán': 'Hàm Hương', 'Số điện thoại': '0936968155', 'Tiêu đề': 'BÁN LÔ ĐƯỜNG NHỰA NHÁNH 765B THÔNG RA TỈNH LỘ 765 - 764 CHỈ VÀI KILOMET', 'Địa chỉ': 'Đường 25B, Xã Bảo Bình, Cẩm Mỹ, Đồng Nai', 'Ngày đăng': '03/06/2022', 'Ngày hết hạn': '18/06/2022', 'Mã tin': '33913057'}, {'Tên người bán': 'Nguyễn Đức', 'Số điện thoại': '0979053999', 'Tiêu đề': 'CHÍNH CHỦ BÁN NHÀ NGÕ 592 SỐ NHÀ 72 TRƯỜNG CHINH', 'Địa chỉ': 'Ngõ 592 số nhà 72, Đường Trường Chinh, Phường Khương Thượng, Đống Đa, Hà Nội', 'Ngày đăng': '14/06/2022', 'Ngày hết hạn': '24/06/2022', 'Mã tin': '34060288'}, {'Tên người bán': 'Nguyen Trong Phu', 'Số điện thoại': '0975495123', 'Tiêu đề': 'BIỆT THỰ BIỂN MẶT HỒ 5 SAO, BỂ BƠI, TRUNG TÂM HẠ LONG, DT 300M2, ĐÔNG NAM, SỔ ĐỎ LÂU DÀI, GIÁ 39 TỶ', 'Địa chỉ': 'Dự án Grand Bay Hạ Long, Đường Hoàng Quốc Việt, Bán đảo 3, Phường Hùng Thắng, Hạ Long, Quảng Ninh', 'Ngày đăng': '14/06/2022', 'Ngày hết hạn': '24/06/2022', 'Mã tin': '34060786'}, {'Tên người bán': 'Anh 7', 'Số điện thoại': '0962657837', 'Tiêu đề': 'BÁN GỐC 2MT QUỐC LỘ (40X45 = 1800M2), CHỢ BECAMEX SỔ HỒNG RIÊNG, THỔ CƯ, ĐƯỜNG 22M BÁN 630 TRIỆU', 'Địa chỉ': '', 'Ngày đăng': '', 'Ngày hết hạn': '', 'Mã tin': ''}]

# find header
s = set()
for i in to_csv:
    s.update(i)
header = list(s)

with open("foo.csv", 'w', encoding="utf-8") as f:
    writer = csv.writer(f)
    writer.writerow(header)
    for d in to_csv:
        writer.writerow([d.get(i, "NULL") for i in header])